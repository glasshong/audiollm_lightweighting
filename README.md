# ì˜¤ë””ì˜¤ ì–¸ì–´ëª¨ë¸ì˜ ê²½ëŸ‰ ëª¨ë¸ë§ ë ˆì„œí”¼ íƒêµ¬

## ğŸ¥‡ íŒ€ êµ¬ì„±ì›

<div align="center">
<table>
  <tr>
    <td align="center">
      <a href="https://github.com/kupulau">
        <img src="https://github.com/user-attachments/assets/d78bb2d1-6469-43e4-9665-eca058f1a2e5" width="120px" height="120px" alt=""/>
        <hr />
        <sub><b>í™©ì§€ì€</b></sub><br />
      </a>
    </td>
    <td align="center">
      <a href="https://github.com/asotea">
        <img src="https://github.com/user-attachments/assets/a15d120c-f086-4f3c-8902-25dd260675ba" width="120px" height="120px" alt=""/>
        <hr />
        <sub><b>ê¹€íƒœê· </b></sub><br />
      </a>
    </td>
    <td align="center">
      <a href="https://github.com/mujjinungae">
        <img src="https://github.com/user-attachments/assets/9098f35a-2002-4f6c-ba66-e3a94310a9f5" width="120px" height="120px" alt=""/>
        <hr />
        <sub><b>ì´ì§„ìš°</b></sub><br />
      </a>
    </td>
    <td align="center">
      <a href="https://github.com/glasshong">
        <img src="https://github.com/user-attachments/assets/5474a1fb-63ca-465e-b85e-0689beb35d87" width="120px" height="120px" alt=""/>
        <hr />
        <sub><b>í™ìœ ë¦¬</b></sub><br />
      </a>
    </td>
    <td align="center">
      <a href="https://github.com/EuiInSeong">
        <img src="https://github.com/user-attachments/assets/6e33239b-6101-4d5d-807a-2a01a7f39cc7" width="120px" height="120px" alt=""/>
        <hr />
        <sub><b>ì„±ì˜ì¸</b></sub><br />
      </a>
    </td>
    <td align="center">
      <a href="https://github.com/jinbong-yeom">
        <img src="https://github.com/user-attachments/assets/73fd05b7-0884-46c8-8b4a-fb787626138c" width="120px" height="120px" alt=""/>
        <hr />
        <sub><b>ì—¼ì§„ë´‰</b></sub><br />
      </a>
    </td>
  </tr>
</table>
</div>

<br />

## ğŸ—’ï¸ í”„ë¡œì íŠ¸ ê°œìš”

"Audio adapterì˜ ê²°í•© ë° ì‚¬ì „í•™ìŠµì„ í†µí•´, ì–¸ì–´ëª¨ë¸ì€ ìŒì„±/ìŒì•…/í™˜ê²½ìŒ ë“±ì˜ ì†Œë¦¬ë¥¼ ì´í•´í•˜ê³  ë‹¤ì–‘í•œ downstream taskë¥¼ ìˆ˜í–‰í•  ìˆ˜ ìˆê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤. VRAMì˜ í¬ê¸°ê°€ ì‘ì€ ì „í˜•ì ì¸ ë””ë°”ì´ìŠ¤ í™˜ê²½ì—ì„œëŠ” ì˜¤ë””ì˜¤ ì–¸ì–´ëª¨ë¸ì— ëŒ€í•œ ê²½ëŸ‰ ëª¨ë¸ë§ì´ í•„ìˆ˜ì ì…ë‹ˆë‹¤. Audio understanding benchmarksì— ëŒ€í•œ baseline ëª¨ë¸ì˜ ì •í™•ë„ë¥¼ ìœ ì§€í•˜ë©´ì„œë„, ë” ì‘ê³  ë¹ ë¥¸ ëª¨ë¸ì„ ë§Œë“œëŠ” ë ˆì„œí”¼ë¥¼ ë””ìì¸í•´ ì£¼ì‹œê¸°ë¥¼ ê¸°ëŒ€í•©ë‹ˆë‹¤."

í•´ë‹¹ í”„ë¡œì íŠ¸ëŠ” ë„¤ì´ë²„ ë¶€ìŠ¤íŠ¸ìº í”„ AI Tech 7ê¸° ê¸°ì—… í•´ì»¤í†¤ìœ¼ë¡œ kaggleì—ì„œ ì§„í–‰ë©ë‹ˆë‹¤.

- ASR í‰ê°€ : https://www.kaggle.com/competitions/boostcamp-7th-nota-hackathon
- AAC í‰ê°€ : https://www.kaggle.com/competitions/boostcamp-7th-nota-hackathon-aac

<br />

## ğŸ“… í”„ë¡œì íŠ¸ ì¼ì •

í”„ë¡œì íŠ¸ ì „ì²´ ì¼ì •

- 2025.01.10 (ê¸ˆ) ~ 2025.02.12 (ìˆ˜)

í”„ë¡œì íŠ¸ ì„¸ë¶€ ì¼ì •

![schedule](https://github.com/user-attachments/assets/f02d1aa3-4c84-48e2-bb59-35f82823366e)

## ğŸ’» ê°œë°œ í™˜ê²½

```bash
- Language : Python
- Environment
  - CPU : Intel(R) Xeon(R) Gold 5120
  - GPU : Tesla V100-SXM2-32GB x 2
- Framework : PyTorch
- Collaborative Tool : Git, Wandb, Notion
```

## ğŸ“ ë°ì´í„°ì…‹ êµ¬ì¡°

```
ğŸ“¦ data
â”œâ”€â”€ ğŸ“‚ audiocaps
â”‚   â”œâ”€â”€ ğŸ“‚ test
â”‚   â””â”€â”€ ğŸ“‚ train
â”œâ”€â”€ ğŸ“‚ Clotho
â”‚   â””â”€â”€ ğŸ“‚ train
â”œâ”€â”€ ğŸ“‚ GigaSpeech
â”‚   â”œâ”€â”€ ğŸ“‚ 0
â”‚   â”œâ”€â”€ ğŸ“‚ 1
â”‚   â”œâ”€â”€ ğŸ“‚ 10
...
â”‚   â””â”€â”€ ğŸ“‚ 9
â”œâ”€â”€ ğŸ“‚ LibriSpeech
â”‚   â”œâ”€â”€ ğŸ“‚ test-other
â”‚   â”œâ”€â”€ ğŸ“‚ train-clean-100
â”‚   â”œâ”€â”€ ğŸ“‚ train-clean-360
â”‚   â””â”€â”€ ğŸ“‚ train-other-500
â”œâ”€â”€ ğŸ“‚ MusicNet
â”‚   â””â”€â”€ ğŸ“‚ train
â””â”€â”€ ğŸ“‚ WavCaps
    â”œâ”€â”€ ğŸ“‚ AudioSet_SL
    â”œâ”€â”€ ğŸ“‚ BBC_Sound_Effects
    â”œâ”€â”€ ğŸ“‚ FreeSound
    â””â”€â”€ ğŸ“‚ SoundBible
```

- í•™ìŠµì— ì‚¬ìš©í•˜ëŠ” ì˜¤ë””ì˜¤ íŒŒì¼ì€ 1,609,722ê°œ, ì¶”ë¡ ì— ì‚¬ìš©í•˜ëŠ” ì˜¤ë””ì˜¤ íŒŒì¼ì€ 7,294ê°œ ì €ì¥ë˜ì–´ ìˆìŠµë‹ˆë‹¤. 
- ì œê³µë˜ëŠ” ì˜¤ë””ì˜¤ íŒŒì¼ì€ wav, flac í˜•ì‹ìœ¼ë¡œ ëœ speech, non-speech soundë¡œ êµ¬ì„±ë˜ì–´ ìˆìŠµë‹ˆë‹¤.
- json íŒŒì¼ì€ ê° ì˜¤ë””ì˜¤ íŒŒì¼ì— ëŒ€í•œ Automatic Speech Recognition, Automatic Audio Captioning ë“±ì˜ annotation ë‚´ìš©ì´ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

<br />

## ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡° 

```
ğŸ“¦level4-cv-finalproject-hackathon-cv-03-lv3
 â”£ ğŸ“‚audiolm-trainer
 â”ƒ â”£ ğŸ“‚configs
 â”ƒ â”ƒ â”£ ğŸ“œtrain_stage1.yaml
 â”ƒ â”ƒ â”— ğŸ“œtrain_stage2.yaml
 â”ƒ â”£ ğŸ“‚data
 â”ƒ â”ƒ â”— ğŸ“œexample_data.json
 â”ƒ â”£ ğŸ“‚models
 â”ƒ â”ƒ â”£ ğŸ“‚beats
 â”ƒ â”ƒ â”ƒ â”£ ğŸ“œBEATs.py
 â”ƒ â”ƒ â”ƒ â”£ ğŸ“œTokenizers.py
 â”ƒ â”ƒ â”ƒ â”£ ğŸ“œ__init__.py
 â”ƒ â”ƒ â”ƒ â”£ ğŸ“œbackbone.py
 â”ƒ â”ƒ â”ƒ â”£ ğŸ“œmodules.py
 â”ƒ â”ƒ â”ƒ â”— ğŸ“œquantizer.py
 â”ƒ â”ƒ â”£ ğŸ“œQformer.py
 â”ƒ â”ƒ â”£ ğŸ“œ__init__.py
 â”ƒ â”ƒ â”£ ğŸ“œmodeling_gemma2.py
 â”ƒ â”ƒ â”£ ğŸ“œmodelling_whisper.py
 â”ƒ â”ƒ â”£ ğŸ“œsalmonn_gemma2.py
 â”ƒ â”ƒ â”— ğŸ“œutils.py
 â”ƒ â”£ ğŸ“‚other_third-party_licenses
 â”ƒ â”ƒ â”£ ğŸ“œLICENSE_vicuna
 â”ƒ â”ƒ â”— ğŸ“œLICENSE_whisper
 â”ƒ â”£ ğŸ“‚prompts
 â”ƒ â”ƒ â”£ ğŸ“œtest_prompt.json
 â”ƒ â”ƒ â”— ğŸ“œtrain_prompt.json
 â”ƒ â”£ ğŸ“œ__init__.py
 â”ƒ â”£ ğŸ“œcli_inference.py
 â”ƒ â”£ ğŸ“œconfig.py
 â”ƒ â”£ ğŸ“œdataset.py
 â”ƒ â”£ ğŸ“œdist_utils.py
 â”ƒ â”£ ğŸ“œlogger.py
 â”ƒ â”£ ğŸ“œoptims.py
 â”ƒ â”£ ğŸ“œrunner.py
 â”ƒ â”£ ğŸ“œtrain.py
 â”ƒ â”— ğŸ“œutils.py
 â”£ ğŸ“‚data
 â”ƒ â”— ğŸ“œenglish.json
 â”£ ğŸ“‚utils
 â”ƒ â”— ğŸ“œwav_to_flac.py
 â”£ ğŸ“œCODE_OF_CONDUCT.md
 â”£ ğŸ“œEDA.ipynb
 â”£ ğŸ“œLICENSE
 â”£ ğŸ“œREADME.md
 â”£ ğŸ“œevaluate_efficiency_salmonn.py
 â”£ ğŸ“œevaluate_salmonn.py
 â”£ ğŸ“œmetrics.py
 â”£ ğŸ“œrequirements.txt
 â”£ ğŸ“œsalmonn_eval_config.yaml
 â”— ğŸ“œsalmonn_utils_gemma2.py
```

- ì´ í”„ë¡œì íŠ¸ëŠ” [nota-github/audiolm-trainer](https://github.com/nota-github/audiolm-trainer), [nota-github/audiolm-evaluator](https://github.com/nota-github/audiolm-evaluator/tree/v1.1) ë° ê·¸ ê¸°ë°˜ì´ ë˜ëŠ” [SALMONN](https://github.com/bytedance/SALMONN) ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•˜ê³  ìˆìŠµë‹ˆë‹¤. 

<br />

## â–¶ï¸ ì‹¤í–‰ ë°©ë²•

#### ì„¤ì¹˜

- Step 1. git clone https://github.com/boostcampaitech7/level4-cv-finalproject-hackathon-cv-03-lv3.git
- Step 2. pip install -r requirements.txt
- Step 3. BEATs_iter3_plus_AS20K_finetuned_on_AS2M_cpt2.pt ë‹¤ìš´ë¡œë“œ
- Step 4. gemma-2-2B-4Bit-GPTQ ëª¨ë¸ íŒŒì¼ ë‹¤ìš´ë¡œë“œ

#### í•™ìŠµ

- stage 1 í•™ìŠµ ì‹œ
`python train.py --cfg-path configs/train_stage1.yaml`

- stage 2 í•™ìŠµ ì‹œ
`python train.py --cfg-path configs/train_stage2.yaml`

#### ì¶”ë¡ 

- ASR, AAC í‰ê°€ ì‹œ
`python evaluate_salmonn.py --cfg-path salmonn_eval_config.yaml --mode {submission_aac, submission_asr, valid_aac, valid_asr}`

- Memory, Latency í‰ê°€ ì‹œ
`python evaluate_efficiency_salmonn.py --cfg-path salmonn_eval_config.yaml`

<br />

## ğŸ’¡ ê²½ëŸ‰í™” solution

#### ê²°ê³¼

|Model|AAC|ASR|Memory|TTFT|TPOT|
|:---------:|:---------:|:---------:|:---------:|:---------:|:---------:|
|Baseline|0.2027|0.0634|9.1761 GB|0.2061 sec|0.0450 sec|
|Our solution|0.3049|0.0642|5.3169 GB|0.3555 sec|0.1072 sec|

- "Gemma-2-2B-4Bit-GPTQ" + "Weight-Lightened Encoder" + "Prompt Engineering"
- 4 bitë¡œ ì–‘ìí™”ëœ LLMê³¼ ê²½ëŸ‰í™”ëœ ë²„ì „ì˜ Whisper, BEATs encoderë¥¼ ì‚¬ìš©í•¨ìœ¼ë¡œì¨ ë©”ëª¨ë¦¬ë¥¼ ì¤„ì´ê³  ì¶”ë¡  ì†ë„ë¥¼ í–¥ìƒ
- Prompt Engieeringê³¼ Instruction tuningì„ í†µí•´ ASR, AAC taskì˜ ì„±ëŠ¥ í–¥ìƒ

<br />

## ë©ì—… ë¦¬í¬íŠ¸
- í”„ë¡œì íŠ¸ ì •ë¦¬ ë° íšŒê³ 
- https://yurihong.notion.site/wrap-up-report-cv-03?pvs=4

<br />
